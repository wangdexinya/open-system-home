# 广告保护：建议加密的 PHP 文件

为保护广告链接与整站禁用逻辑不被逆向删除或篡改，**仅对下面 3 个与广告保护强相关的文件做加密**即可，其余 PHP 保持明文，方便其他开发者做二次美化与功能扩展。

---

## 需要加密的文件（共 4 个）

| 文件 | 作用 | 不加密的风险 |
|------|------|--------------|
| **api/ad_protect.php** | 定义广告保护密钥、禁用标记路径、**正确广告 URL** | 可直接看到密钥与正确链接、改逻辑或删文件以绕过保护 |
| **api/verify_ad.php** | 接收前端提交的广告 href，与正确 URL 比对后返回 `valid` | 可被改成始终返回 `valid: true`，广告校验失效 |
| **api/disable.php** | 校验密钥后写入「整站禁用」标记 | 可被改成空逻辑或删除，使篡改广告后无法触发禁用 |
| **api/status.php** | 读取禁用标记并返回 `disabled` 状态 | 可被改成始终返回 `disabled: false`，整站禁用失效 |

加密工具示例：**ionCube Loader**、**SourceGuardian**、**Zend Guard** 等。加密后需在服务器安装对应 Loader 扩展，否则无法运行。

---

## 不要加密的文件（便于二次开发）

| 文件 | 说明 |
|------|------|
| **api/config.php** | 数据目录、会话、CORS、通用响应等，常需按环境调整 |
| **api/auth.php** | 登录、登出、改密等，可能需加验证码、双因素等 |
| **api/data.php** | 站点数据读写、导出导入，可能需加字段或权限 |
| **api/message.php** | 留言提交与管理，可能需加审核、通知等 |
| **api/nuke.php** | 一键跑路，可按需求改逻辑或关闭 |

以上保持**明文**，其他开发者可自由修改接口、字段、校验和业务逻辑，不影响广告保护（保护逻辑集中在上述 3 个加密文件中）。

---

## 总结

- **只加密**：`ad_protect.php`、`verify_ad.php`、`disable.php`、`status.php`（正确广告 URL 与校验逻辑均在加密文件中，前端无法篡改「标准答案」）  
- **不加密**：`config.php`、`auth.php`、`data.php`、`message.php`、`nuke.php`  

这样既能保护广告内容与整站禁用机制不被简单逆向删除，又不影响其他开发者对站点做二次美化与功能开发。
